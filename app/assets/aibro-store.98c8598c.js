import{c as computed,k as createComponent,r as ref,w as watch,n as onBeforeUnmount,h,ak as Transition,l as hSlot,al as QSpinner,y as client,am as getEmptyStorage,an as getStorage,ao as Plugin$1,ap as isDate,aq as defaultLang,ar as defineStore,as as Plugin$2,at as Notify}from"./index.a11a8867.js";import{a as axios}from"./axios.6e1fcf85.js";function capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)}function between(t,n,r){return r<=n?n:Math.min(r,Math.max(n,t))}function normalizeToInterval(t,n,r){if(r<=n)return n;const a=r-n+1;let s=n+(t-n)%a;return s<n&&(s=a+s),s===0?0:s}function pad(t,n=2,r="0"){if(t==null)return t;const a=""+t;return a.length>=n?a:new Array(n-a.length+1).join(r)+a}const useRatioProps={ratio:[String,Number]};function useRatio(t,n){return computed(()=>{const r=Number(t.ratio||(n!==void 0?n.value:void 0));return isNaN(r)!==!0&&r>0?{paddingBottom:`${100/r}%`}:null})}const defaultRatio=16/9;var QImg=createComponent({name:"QImg",props:{...useRatioProps,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:defaultRatio},placeholderSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(t,{slots:n,emit:r}){const a=ref(t.initialRatio),s=useRatio(t,a);let i=null,c=!1;const o=[ref(null),ref(M())],l=ref(0),m=ref(!1),u=ref(!1),d=computed(()=>`q-img q-img--${t.noNativeMenu===!0?"no-":""}menu`),y=computed(()=>({width:t.width,height:t.height})),f=computed(()=>`q-img__image ${t.imgClass!==void 0?t.imgClass+" ":""}q-img__image--with${t.noTransition===!0?"out":""}-transition`),D=computed(()=>({...t.imgStyle,objectFit:t.fit,objectPosition:t.position}));watch(()=>v(),S);function v(){return t.src||t.srcset||t.sizes?{src:t.src,srcset:t.srcset,sizes:t.sizes}:null}function M(){return t.placeholderSrc!==void 0?{src:t.placeholderSrc}:null}function S(g){i!==null&&(clearTimeout(i),i=null),u.value=!1,g===null?(m.value=!1,o[l.value^1].value=M()):m.value=!0,o[l.value].value=g}function I({target:g}){c!==!0&&(i!==null&&(clearTimeout(i),i=null),a.value=g.naturalHeight===0?.5:g.naturalWidth/g.naturalHeight,w(g,1))}function w(g,_){c===!0||_===1e3||(g.complete===!0?$(g):i=setTimeout(()=>{i=null,w(g,_+1)},50))}function $(g){c!==!0&&(l.value=l.value^1,o[l.value].value=null,m.value=!1,u.value=!1,r("load",g.currentSrc||g.src))}function x(g){i!==null&&(clearTimeout(i),i=null),m.value=!1,u.value=!0,o[l.value].value=null,o[l.value^1].value=M(),r("error",g)}function Y(g){const _=o[g].value,p={key:"img_"+g,class:f.value,style:D.value,crossorigin:t.crossorigin,decoding:t.decoding,referrerpolicy:t.referrerpolicy,height:t.height,width:t.width,loading:t.loading,fetchpriority:t.fetchpriority,"aria-hidden":"true",draggable:t.draggable,..._};return l.value===g?(p.class+=" q-img__image--waiting",Object.assign(p,{onLoad:I,onError:x})):p.class+=" q-img__image--loaded",h("div",{class:"q-img__container absolute-full",key:"img"+g},h("img",p))}function O(){return m.value!==!0?h("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},hSlot(n[u.value===!0?"error":"default"])):h("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},n.loading!==void 0?n.loading():t.noSpinner===!0?void 0:[h(QSpinner,{color:t.spinnerColor,size:t.spinnerSize})])}return S(v()),onBeforeUnmount(()=>{c=!0,i!==null&&(clearTimeout(i),i=null)}),()=>{const g=[];return s.value!==null&&g.push(h("div",{key:"filler",style:s.value})),u.value!==!0&&(o[0].value!==null&&g.push(Y(0)),o[1].value!==null&&g.push(Y(1))),g.push(h(Transition,{name:"q-transition--fade"},O)),h("div",{class:d.value,style:y.value,role:"img","aria-label":t.alt},g)}}});const storage=client.has.webStorage===!1?getEmptyStorage():getStorage("session"),Plugin={install({$q:t}){t.sessionStorage=storage}};Object.assign(Plugin,storage);const breaks=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178];function isLeapJalaaliYear(t){return jalCalLeap(t)===0}function jalaaliMonthLength(t,n){return n<=6?31:n<=11||isLeapJalaaliYear(t)?30:29}function jalCalLeap(t){const n=breaks.length;let r=breaks[0],a,s,i,c,o;if(t<r||t>=breaks[n-1])throw new Error("Invalid Jalaali year "+t);for(o=1;o<n&&(a=breaks[o],s=a-r,!(t<a));o+=1)r=a;return c=t-r,s-c<6&&(c=c-s+div(s+4,33)*33),i=mod(mod(c+1,33)-1,4),i===-1&&(i=4),i}function div(t,n){return~~(t/n)}function mod(t,n){return t-~~(t/n)*n}const MILLISECONDS_IN_DAY=864e5,MILLISECONDS_IN_HOUR=36e5,MILLISECONDS_IN_MINUTE=6e4,defaultMask="YYYY-MM-DDTHH:mm:ss.SSSZ",token=/\[((?:[^\]\\]|\\]|\\)*)\]|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]/g,reverseToken=/(\[[^\]]*\])|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]|([.*+:?^,\s${}()|\\]+)/g,regexStore={};function getRegexData(t,n){const r="("+n.days.join("|")+")",a=t+r;if(regexStore[a]!==void 0)return regexStore[a];const s="("+n.daysShort.join("|")+")",i="("+n.months.join("|")+")",c="("+n.monthsShort.join("|")+")",o={};let l=0;const m=t.replace(reverseToken,d=>{switch(l++,d){case"YY":return o.YY=l,"(-?\\d{1,2})";case"YYYY":return o.YYYY=l,"(-?\\d{1,4})";case"M":return o.M=l,"(\\d{1,2})";case"MM":return o.M=l,"(\\d{2})";case"MMM":return o.MMM=l,c;case"MMMM":return o.MMMM=l,i;case"D":return o.D=l,"(\\d{1,2})";case"Do":return o.D=l++,"(\\d{1,2}(st|nd|rd|th))";case"DD":return o.D=l,"(\\d{2})";case"H":return o.H=l,"(\\d{1,2})";case"HH":return o.H=l,"(\\d{2})";case"h":return o.h=l,"(\\d{1,2})";case"hh":return o.h=l,"(\\d{2})";case"m":return o.m=l,"(\\d{1,2})";case"mm":return o.m=l,"(\\d{2})";case"s":return o.s=l,"(\\d{1,2})";case"ss":return o.s=l,"(\\d{2})";case"S":return o.S=l,"(\\d{1})";case"SS":return o.S=l,"(\\d{2})";case"SSS":return o.S=l,"(\\d{3})";case"A":return o.A=l,"(AM|PM)";case"a":return o.a=l,"(am|pm)";case"aa":return o.aa=l,"(a\\.m\\.|p\\.m\\.)";case"ddd":return s;case"dddd":return r;case"Q":case"d":case"E":return"(\\d{1})";case"Qo":return"(1st|2nd|3rd|4th)";case"DDD":case"DDDD":return"(\\d{1,3})";case"w":return"(\\d{1,2})";case"ww":return"(\\d{2})";case"Z":return o.Z=l,"(Z|[+-]\\d{2}:\\d{2})";case"ZZ":return o.ZZ=l,"(Z|[+-]\\d{2}\\d{2})";case"X":return o.X=l,"(-?\\d+)";case"x":return o.x=l,"(-?\\d{4,})";default:return l--,d[0]==="["&&(d=d.substring(1,d.length-1)),d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}),u={map:o,regex:new RegExp("^"+m)};return regexStore[a]=u,u}function getDateLocale(t,n){return t!==void 0?t:n!==void 0?n.date:defaultLang.date}function formatTimezone(t,n=""){const r=t>0?"-":"+",a=Math.abs(t),s=Math.floor(a/60),i=a%60;return r+pad(s)+n+pad(i)}function applyYearMonthDayChange(t,n,r){let a=t.getFullYear(),s=t.getMonth();const i=t.getDate();return n.year!==void 0&&(a+=r*n.year,delete n.year),n.month!==void 0&&(s+=r*n.month,delete n.month),t.setDate(1),t.setMonth(2),t.setFullYear(a),t.setMonth(s),t.setDate(Math.min(i,daysInMonth(t))),n.date!==void 0&&(t.setDate(t.getDate()+r*n.date),delete n.date),t}function applyYearMonthDay(t,n,r){const a=n.year!==void 0?n.year:t[`get${r}FullYear`](),s=n.month!==void 0?n.month-1:t[`get${r}Month`](),i=new Date(a,s+1,0).getDate(),c=Math.min(i,n.date!==void 0?n.date:t[`get${r}Date`]());return t[`set${r}Date`](1),t[`set${r}Month`](2),t[`set${r}FullYear`](a),t[`set${r}Month`](s),t[`set${r}Date`](c),delete n.year,delete n.month,delete n.date,t}function getChange(t,n,r){const a=normalizeMod(n),s=new Date(t),i=a.year!==void 0||a.month!==void 0||a.date!==void 0?applyYearMonthDayChange(s,a,r):s;for(const c in a){const o=capitalize(c);i[`set${o}`](i[`get${o}`]()+r*a[c])}return i}function normalizeMod(t){const n={...t};return t.years!==void 0&&(n.year=t.years,delete n.years),t.months!==void 0&&(n.month=t.months,delete n.months),t.days!==void 0&&(n.date=t.days,delete n.days),t.day!==void 0&&(n.date=t.day,delete n.day),t.hour!==void 0&&(n.hours=t.hour,delete n.hour),t.minute!==void 0&&(n.minutes=t.minute,delete n.minute),t.second!==void 0&&(n.seconds=t.second,delete n.second),t.millisecond!==void 0&&(n.milliseconds=t.millisecond,delete n.millisecond),n}function adjustDate(t,n,r){const a=normalizeMod(n),s=r===!0?"UTC":"",i=new Date(t),c=a.year!==void 0||a.month!==void 0||a.date!==void 0?applyYearMonthDay(i,a,s):i;for(const o in a){const l=o.charAt(0).toUpperCase()+o.slice(1);c[`set${s}${l}`](a[o])}return c}function extractDate(t,n,r){const a=__splitDate(t,n,r),s=new Date(a.year,a.month===null?null:a.month-1,a.day===null?1:a.day,a.hour,a.minute,a.second,a.millisecond),i=s.getTimezoneOffset();return a.timezoneOffset===null||a.timezoneOffset===i?s:getChange(s,{minutes:a.timezoneOffset-i},1)}function __splitDate(t,n,r,a,s){const i={year:null,month:null,day:null,hour:null,minute:null,second:null,millisecond:null,timezoneOffset:null,dateHash:null,timeHash:null};if(s!==void 0&&Object.assign(i,s),t==null||t===""||typeof t!="string")return i;n===void 0&&(n=defaultMask);const c=getDateLocale(r,Plugin$1.props),o=c.months,l=c.monthsShort,{regex:m,map:u}=getRegexData(n,c),d=t.match(m);if(d===null)return i;let y="";if(u.X!==void 0||u.x!==void 0){const f=parseInt(d[u.X!==void 0?u.X:u.x],10);if(isNaN(f)===!0||f<0)return i;const D=new Date(f*(u.X!==void 0?1e3:1));i.year=D.getFullYear(),i.month=D.getMonth()+1,i.day=D.getDate(),i.hour=D.getHours(),i.minute=D.getMinutes(),i.second=D.getSeconds(),i.millisecond=D.getMilliseconds()}else{if(u.YYYY!==void 0)i.year=parseInt(d[u.YYYY],10);else if(u.YY!==void 0){const f=parseInt(d[u.YY],10);i.year=f<0?f:2e3+f}if(u.M!==void 0){if(i.month=parseInt(d[u.M],10),i.month<1||i.month>12)return i}else u.MMM!==void 0?i.month=l.indexOf(d[u.MMM])+1:u.MMMM!==void 0&&(i.month=o.indexOf(d[u.MMMM])+1);if(u.D!==void 0){if(i.day=parseInt(d[u.D],10),i.year===null||i.month===null||i.day<1)return i;const f=a!=="persian"?new Date(i.year,i.month,0).getDate():jalaaliMonthLength(i.year,i.month);if(i.day>f)return i}u.H!==void 0?i.hour=parseInt(d[u.H],10)%24:u.h!==void 0&&(i.hour=parseInt(d[u.h],10)%12,(u.A&&d[u.A]==="PM"||u.a&&d[u.a]==="pm"||u.aa&&d[u.aa]==="p.m.")&&(i.hour+=12),i.hour=i.hour%24),u.m!==void 0&&(i.minute=parseInt(d[u.m],10)%60),u.s!==void 0&&(i.second=parseInt(d[u.s],10)%60),u.S!==void 0&&(i.millisecond=parseInt(d[u.S],10)*10**(3-d[u.S].length)),(u.Z!==void 0||u.ZZ!==void 0)&&(y=u.Z!==void 0?d[u.Z].replace(":",""):d[u.ZZ],i.timezoneOffset=(y[0]==="+"?-1:1)*(60*y.slice(1,3)+1*y.slice(3,5)))}return i.dateHash=pad(i.year,6)+"/"+pad(i.month)+"/"+pad(i.day),i.timeHash=pad(i.hour)+":"+pad(i.minute)+":"+pad(i.second)+y,i}function isValid(t){return typeof t=="number"?!0:isNaN(Date.parse(t))===!1}function buildDate(t,n){return adjustDate(new Date,t,n)}function getDayOfWeek(t){const n=new Date(t).getDay();return n===0?7:n}function getWeekOfYear(t){const n=new Date(t.getFullYear(),t.getMonth(),t.getDate());n.setDate(n.getDate()-(n.getDay()+6)%7+3);const r=new Date(n.getFullYear(),0,4);r.setDate(r.getDate()-(r.getDay()+6)%7+3);const a=n.getTimezoneOffset()-r.getTimezoneOffset();n.setHours(n.getHours()-a);const s=(n-r)/(MILLISECONDS_IN_DAY*7);return 1+Math.floor(s)}function getDayIdentifier(t){return t.getFullYear()*1e4+t.getMonth()*100+t.getDate()}function getDateIdentifier(t,n){const r=new Date(t);return n===!0?getDayIdentifier(r):r.getTime()}function isBetweenDates(t,n,r,a={}){const s=getDateIdentifier(n,a.onlyDate),i=getDateIdentifier(r,a.onlyDate),c=getDateIdentifier(t,a.onlyDate);return(c>s||a.inclusiveFrom===!0&&c===s)&&(c<i||a.inclusiveTo===!0&&c===i)}function addToDate(t,n){return getChange(t,n,1)}function subtractFromDate(t,n){return getChange(t,n,-1)}function startOfDate(t,n,r){const a=new Date(t),s=`set${r===!0?"UTC":""}`;switch(n){case"year":case"years":a[`${s}Month`](0);case"month":case"months":a[`${s}Date`](1);case"day":case"days":case"date":a[`${s}Hours`](0);case"hour":case"hours":a[`${s}Minutes`](0);case"minute":case"minutes":a[`${s}Seconds`](0);case"second":case"seconds":a[`${s}Milliseconds`](0)}return a}function endOfDate(t,n,r){const a=new Date(t),s=`set${r===!0?"UTC":""}`;switch(n){case"year":case"years":a[`${s}Month`](11);case"month":case"months":a[`${s}Date`](daysInMonth(a));case"day":case"days":case"date":a[`${s}Hours`](23);case"hour":case"hours":a[`${s}Minutes`](59);case"minute":case"minutes":a[`${s}Seconds`](59);case"second":case"seconds":a[`${s}Milliseconds`](999)}return a}function getMaxDate(t){let n=new Date(t);return Array.prototype.slice.call(arguments,1).forEach(r=>{n=Math.max(n,new Date(r))}),n}function getMinDate(t){let n=new Date(t);return Array.prototype.slice.call(arguments,1).forEach(r=>{n=Math.min(n,new Date(r))}),n}function getDiff(t,n,r){return(t.getTime()-t.getTimezoneOffset()*MILLISECONDS_IN_MINUTE-(n.getTime()-n.getTimezoneOffset()*MILLISECONDS_IN_MINUTE))/r}function getDateDiff(t,n,r="days"){const a=new Date(t),s=new Date(n);switch(r){case"years":case"year":return a.getFullYear()-s.getFullYear();case"months":case"month":return(a.getFullYear()-s.getFullYear())*12+a.getMonth()-s.getMonth();case"days":case"day":case"date":return getDiff(startOfDate(a,"day"),startOfDate(s,"day"),MILLISECONDS_IN_DAY);case"hours":case"hour":return getDiff(startOfDate(a,"hour"),startOfDate(s,"hour"),MILLISECONDS_IN_HOUR);case"minutes":case"minute":return getDiff(startOfDate(a,"minute"),startOfDate(s,"minute"),MILLISECONDS_IN_MINUTE);case"seconds":case"second":return getDiff(startOfDate(a,"second"),startOfDate(s,"second"),1e3)}}function getDayOfYear(t){return getDateDiff(t,startOfDate(t,"year"),"days")+1}function inferDateFormat(t){return isDate(t)===!0?"date":typeof t=="number"?"number":"string"}function getDateBetween(t,n,r){const a=new Date(t);if(n){const s=new Date(n);if(a<s)return s}if(r){const s=new Date(r);if(a>s)return s}return a}function isSameDate(t,n,r){const a=new Date(t),s=new Date(n);if(r===void 0)return a.getTime()===s.getTime();switch(r){case"second":case"seconds":if(a.getSeconds()!==s.getSeconds())return!1;case"minute":case"minutes":if(a.getMinutes()!==s.getMinutes())return!1;case"hour":case"hours":if(a.getHours()!==s.getHours())return!1;case"day":case"days":case"date":if(a.getDate()!==s.getDate())return!1;case"month":case"months":if(a.getMonth()!==s.getMonth())return!1;case"year":case"years":if(a.getFullYear()!==s.getFullYear())return!1;break;default:throw new Error(`date isSameDate unknown unit ${r}`)}return!0}function daysInMonth(t){return new Date(t.getFullYear(),t.getMonth()+1,0).getDate()}function getOrdinal(t){if(t>=11&&t<=13)return`${t}th`;switch(t%10){case 1:return`${t}st`;case 2:return`${t}nd`;case 3:return`${t}rd`}return`${t}th`}const formatter={YY(t,n,r){const a=this.YYYY(t,n,r)%100;return a>=0?pad(a):"-"+pad(Math.abs(a))},YYYY(t,n,r){return r!=null?r:t.getFullYear()},M(t){return t.getMonth()+1},MM(t){return pad(t.getMonth()+1)},MMM(t,n){return n.monthsShort[t.getMonth()]},MMMM(t,n){return n.months[t.getMonth()]},Q(t){return Math.ceil((t.getMonth()+1)/3)},Qo(t){return getOrdinal(this.Q(t))},D(t){return t.getDate()},Do(t){return getOrdinal(t.getDate())},DD(t){return pad(t.getDate())},DDD(t){return getDayOfYear(t)},DDDD(t){return pad(getDayOfYear(t),3)},d(t){return t.getDay()},dd(t,n){return this.dddd(t,n).slice(0,2)},ddd(t,n){return n.daysShort[t.getDay()]},dddd(t,n){return n.days[t.getDay()]},E(t){return t.getDay()||7},w(t){return getWeekOfYear(t)},ww(t){return pad(getWeekOfYear(t))},H(t){return t.getHours()},HH(t){return pad(t.getHours())},h(t){const n=t.getHours();return n===0?12:n>12?n%12:n},hh(t){return pad(this.h(t))},m(t){return t.getMinutes()},mm(t){return pad(t.getMinutes())},s(t){return t.getSeconds()},ss(t){return pad(t.getSeconds())},S(t){return Math.floor(t.getMilliseconds()/100)},SS(t){return pad(Math.floor(t.getMilliseconds()/10))},SSS(t){return pad(t.getMilliseconds(),3)},A(t){return this.H(t)<12?"AM":"PM"},a(t){return this.H(t)<12?"am":"pm"},aa(t){return this.H(t)<12?"a.m.":"p.m."},Z(t,n,r,a){const s=a==null?t.getTimezoneOffset():a;return formatTimezone(s,":")},ZZ(t,n,r,a){const s=a==null?t.getTimezoneOffset():a;return formatTimezone(s)},X(t){return Math.floor(t.getTime()/1e3)},x(t){return t.getTime()}};function formatDate(t,n,r,a,s){if(t!==0&&!t||t===1/0||t===-1/0)return;const i=new Date(t);if(isNaN(i))return;n===void 0&&(n=defaultMask);const c=getDateLocale(r,Plugin$1.props);return n.replace(token,(o,l)=>o in formatter?formatter[o](i,c,a,s):l===void 0?o:l.split("\\]").join("]"))}function clone(t){return isDate(t)===!0?new Date(t.getTime()):t}var date={isValid,extractDate,buildDate,getDayOfWeek,getWeekOfYear,isBetweenDates,addToDate,subtractFromDate,adjustDate,startOfDate,endOfDate,getMaxDate,getMinDate,getDateDiff,getDayOfYear,inferDateFormat,getDateBetween,isSameDate,daysInMonth,formatDate,clone};const useAibroStore=defineStore("aibro",{state:()=>{let t={prompt:"Astronaut in a jungle, cold color palette, muted colors, detailed, 8k",negative_prompt:"",seed:Math.round(Math.random()*1e5),width:1024,height:1024,num_inference_steps:50,guidance_scale:5,guidance_rescale:0,original_size_width:1024,original_size_height:1024,target_size_width:1024,target_size_height:1024,crops_coords_top_left_x:0,crops_coords_top_left_y:0,job_type:0,input_image:null,controlnet_conditioning_scale:.5};for(const n in t)try{const r=Plugin$2.getItem("txt2img_"+n);r&&(t[n]=r)}catch(r){console.log(r)}return t={...t,since:void 0,history:[],loading:!1,loading_history:!1,output_image:Plugin$2.getItem("txt2img_output_image"),prompt_script:Plugin$2.getItem("txt2img_prompt_script")||""},t},actions:{del_history(t){return this.loading_history=!0,axios.delete(`/api/history/${encodeURIComponent(t.id)}`)},load_history(t,n,r,a){return this.loading_history=!0,axios.post("/api/history",{page:t,rowsPerPage:n,sortBy:r||"id",descending:a})},reload_history(){this.loading_history=!0,axios.get("/api/history").then(({data:t})=>{console.log(t),this.history=t.sort((n,r)=>r.id.localeCompare(n.id)),this.loading_history=!1})},copy_history(t){this.loading=!0;for(const n in t)n in this&&(this[n]=t[n]);this.output_image=`/output/${encodeURIComponent(t.id)}/image.png`,this.loading=!1},txt2img_check(t,n){axios.get(`/api/txt2img/${encodeURIComponent(t)}`).then(({data:r})=>{r.status?(this.since=`${date.getDateDiff(new Date(r.tick),new Date(t),"seconds")} seconds...`,setTimeout(()=>this.txt2img_check(t,n),2e3)):(this.output_image=`/output/${encodeURIComponent(t)}/image.png`,Plugin$2.set("txt2img_output_image",`/output/${encodeURIComponent(t)}/image.png`),Plugin$2.set("job_id",void 0),this.reload_history(),n.length==0?this.loading=!1:this.txt2img_runonserver(n))}).catch(r=>{Notify.create(`Error: ${r}`),Plugin$2.set("job_id",void 0),this.loading=!1})},txt2img_run(){this.loading=!0;const data={prompt:this.prompt,prompt_script:this.prompt_script,negative_prompt:this.negative_prompt,seed:this.seed,width:this.width,height:this.height,num_inference_steps:this.num_inference_steps,guidance_scale:this.guidance_scale,guidance_rescale:this.guidance_rescale,original_size_width:this.original_size_width,original_size_height:this.original_size_height,target_size_width:this.target_size_width,target_size_height:this.target_size_height,crops_coords_top_left_x:this.crops_coords_top_left_x,crops_coords_top_left_y:this.crops_coords_top_left_y,job_type:this.job_type,input_image:this.input_image,controlnet_conditioning_scale:this.controlnet_conditioning_scale};let queue=[data];if(this.prompt_script.trim().length>0)try{const e=eval(this.prompt_script);queue=e(data)}catch(t){Notify.create(`Eval error: ${t}`),this.loading=!1;return}for(const t of Object.keys(data)){const n=t,r=data[t];if(r)try{Plugin$2.set("txt2img_"+n,r)}catch(a){Notify.create(`Error save params: ${a}`)}else Plugin$2.remove("txt2img_"+n)}queue.length>1?axios.post("/api/txt2imgs",queue).then(({data:t})=>{Plugin$2.set("txt2img_job_id",t.id),this.txt2img_check(t.id,[])}).catch(t=>{Notify.create(`Error: ${t}`),this.loading=!1}):this.txt2img_runonserver(queue)},txt2img_runonserver(t){const n=t.shift();axios.post("/api/txt2img",n).then(({data:r})=>{Plugin$2.set("txt2img_job_id",r.id),this.txt2img_check(r.id,t)}).catch(r=>{Notify.create(`Error: ${r}`),this.loading=!1})}}});export{QImg as Q,between as b,normalizeToInterval as n,useAibroStore as u};
